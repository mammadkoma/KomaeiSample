@page "/EditModels"
@layout PanelLayout
<PageTitle>مدل ها</PageTitle>

<MudForm @ref="form" Model="vm" Class="col-md-8 mx-auto">
    <MudGrid Justify="Justify.Center" Class="mt-1">
        <MudItem xs="12" sm="7">
            <MudSelect T="int?" Label="دسته *" @bind-Value="vm!.CategoryId" @bind-Value:after="OnCategoryChange" For="@(() => vm!.CategoryId)" Variant="Variant.Outlined">
                @foreach (var item in categories!)
                {
                    <MudSelectItem Value="@((int?)item.Id)">@item.Title</MudSelectItem>
                }
            </MudSelect>

            <MudSelect T="int?" Label="مدل *" @bind-Value="vm!.Id" @bind-Value:after="OnModelChange" For="@(() => vm!.Id)" Variant="Variant.Outlined">
                @foreach (var item in Models!)
                {
                    <MudSelectItem Value="@((int?)item.Id)">@item.Title</MudSelectItem>
                }
            </MudSelect>

            @if (SelectedModel.FileName != null)
            {
                <MudGrid Justify="Justify.Center">
                    <MudItem xs="12" class="d-flex justify-content-center">
                        <MudImage Src="@("Uploads/Model/" + SelectedModel.FileName + SelectedModel.FileExtension)" Fluid Class="mt-2 rounded" />
                    </MudItem>
                </MudGrid>
            }

            <MudFileUpload T="IBrowserFile" @bind-Files="vm.File" For="@(() => vm.File)" SuppressOnChangeWhenInvalid Accept=".png,.jpg,.jpeg">
                <ActivatorContent>
                    <MudButton Variant="Variant.Filled" Color="Color.Default" StartIcon="@Icons.Material.Filled.CloudUpload" FullWidth Class="mt-3">
                        انتخاب تصویر (حداکثر 200 KB)
                    </MudButton>
                </ActivatorContent>
            </MudFileUpload>

            <MudGrid Justify="Justify.Center" Class="mt-1">
                <MudButton OnClick="Submit" Variant="Variant.Filled" Class="w-50 mt-5"
                           Color="Color.Success" FullWidth="true" Size="Size.Large" Disabled="vm.File==null">
                    ذخیره
                </MudButton>
            </MudGrid>
        </MudItem>
    </MudGrid>
</MudForm>